<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
    <link rel="icon" href="./images/favicon.ico">
    <link rel="apple-touch-icon" href="./images/apple-touch-icon.png">

    <title>received bill</title>
    <link rel="stylesheet" type="text/css" href="./css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/bootstrap-datepicker3.standalone.min.css">
    <link rel="stylesheet" type="text/css" href="./css/backend.css">


    <!--[if lt IE 9]>
    <script src="./js/libs/html5shiv.min.js"></script>
    <script src="./js/libs/respond.min.js"></script>
    <![endif]-->

</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-md-12 trim-col">
            <div class="admin-header">
                <img src="./images/admin_mgr_logo.png" alt="admin manager logo" class="admin-logo" width="300" height="100">
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-2 trim-col">
            <div class="admin-sidebar" id="admin-side-menu">
                <div class="panel sidebar-section">
                    <a data-toggle="collapse" data-parent="#admin-side-menu" class="collapsed has-subside" href="#order-receivable-menu">
                        订单收款
                        <span class="pull-right glyphicon glyphicon-menu-right"></span>
                        <span class="pull-right glyphicon glyphicon-menu-down"></span>
                    </a>
                    <div id="order-receivable-menu" class="panel-collapse collapse">
                        <ul class="subside-menu">
                            <li><a href="#">订单收款</a></li>
                            <li><a href="#">收款记录</a></li>
                        </ul>
                    </div>
                </div>
                <div class="panel sidebar-section">
                    <a data-toggle="collapse" data-parent="#admin-side-menu" class="collapsed has-subside" href="#load-return-menu">
                        货款回笼
                        <span class="pull-right glyphicon glyphicon-menu-right"></span>
                        <span class="pull-right glyphicon glyphicon-menu-down"></span>
                    </a>
                    <div id="load-return-menu" class="panel-collapse collapse">
                        <ul class="subside-menu">
                            <li><a href="#">回笼记录</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-10 trim-right">
            <div class="order-search">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <form action="" id="received-bill-form">
                            <div class="row">
                                <div class="col-md-10 trim-right">
                                    <div class="form-inline">
                                        <div class="form-group">
                                            <label>订单号：</label>
                                            <input type="text" class="form-control" name="order_num">
                                        </div>
                                        <div class="form-group">
                                            <label>收款点：</label>
                                            <select class="form-control" name="pay_store">
                                                <option value="1">柯咔胡志明A门店</option>
                                                <option value="1">柯咔胡志明b门店</option>
                                                <option value="1">柯咔胡志明C门店</option>
                                            </select>
                                        </div>

                                        <div class="form-group">
                                            <label>收款人：</label>
                                            <select class="form-control" name="payee">
                                                <option value="1">张三</option>
                                                <option value="1">张三</option>
                                                <option value="1">张三</option>
                                            </select>
                                        </div>
                                        <div class="form-group has-float">
                                            <label>收款时间：</label>
                                            <div class="pull-right">
                                                <div class="input-daterange input-group" id="submit-range">
                                                    <input type="text" class="form-control" name="start" />
                                                    <span class="input-group-addon">到</span>
                                                    <input type="text" class="form-control" name="end" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2 order-btn-holder">
                                    <button type="submit" class="btn btn-primary btn-block order-btn">搜索</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="order-list received-bill">
                <div class="order-list-sum text-right">
                    总收款金额： <span class="order-list-sum-price"><span class="js-received-bill-total">5643675454723 </span> VND</span>
                </div>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th rowspan="2">序号</th>
                            <th rowspan="2">回笼资金 <br/>(资金缺口)</th>
                            <th rowspan="2">收款点</th>
                            <th rowspan="2">提交人</th>
                            <th rowspan="2">提交时间</th>
                            <th colspan="4">订单信息</th>
                            <th rowspan="2">备注</th>
                            <th rowspan="2" width="11%">操作</th>
                        </tr>
                        <tr>
                            <th>订单总额</th>
                            <th>订单号</th>
                            <th>订单金额</th>
                            <th width="6%">收款人</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="js-this-tr" data-id="1">
                            <td rowspan="7">1</td>
                            <td rowspan="7">32324464 VND <br/>(<span class="received-bill-more">+9 VND</span>)</td>
                            <td rowspan="7">柯咔胡志明A门店</td>
                            <td rowspan="7">李四</td>
                            <td rowspan="7">2015/9/25 10:27</td>
                            <td rowspan="7"><span class="js-sub-total">5426757857</span> VND</td>
                            <td><a href="#">6756484758785768784</a></td>
                            <td><span class="js-single-price">67367</span> VND</td>
                            <td>张三</td>
                            <td rowspan="7">这个订单是延迟了一点点才汇款的</td>
                            <td rowspan="7">
                                <a href="#" class="received-bill-action">确认到账</a>
                                <a href="#" class="received-bill-action">查看转账凭证</a>
                                <a href="#" class="received-bill-action">标记为异常</a>
                            </td>
                        </tr>
                        <tr data-par="1">
                            <td><a href="#">6756484758785768784</a></td>
                            <td><span class="js-single-price">67367</span> VND</td>
                            <td>张三</td>
                        </tr>
                        <tr data-par="1">
                            <td><a href="#">6756484758785768784</a></td>
                            <td><span class="js-single-price">67367</span> VND</td>
                            <td>张三</td>
                        </tr>
                        <tr data-par="1">
                            <td><a href="#">6756484758785768784</a></td>
                            <td><span class="js-single-price">67367</span> VND</td>
                            <td>张三</td>
                        </tr>
                        <tr data-par="1">
                            <td><a href="#">6756484758785768784</a></td>
                            <td><span class="js-single-price">67367</span> VND</td>
                            <td>张三</td>
                        </tr>
                        <tr data-par="1">
                            <td><a href="#">6756484758785768784</a></td>
                            <td><span class="js-single-price">67367</span> VND</td>
                            <td>张三</td>
                        </tr>
                        <tr data-par="1">
                            <td><a href="#">6756484758785768784</a></td>
                            <td><span class="js-single-price">67367</span> VND</td>
                            <td>张三</td>
                        </tr>

                        <tr class="js-this-tr" data-id="2">
                            <td rowspan="7">1</td>
                            <td rowspan="7">32324464 VND <br/>(<span class="received-bill-less">-9 VND</span>)</td>
                            <td rowspan="7">柯咔胡志明A门店</td>
                            <td rowspan="7">李四</td>
                            <td rowspan="7">2015/9/25 10:27</td>
                            <td rowspan="7"><span class="js-sub-total">5426757857 </span>VND</td>
                            <td><a href="#">6756484758785768784</a></td>
                            <td><span class="js-single-price">67367</span> VND</td>
                            <td>张三</td>
                            <td rowspan="7">这个订单是延迟了一点点才汇款的</td>
                            <td rowspan="7">
                                <a href="#" class="received-bill-action">确认到账</a>
                                <a href="#" class="received-bill-action">查看转账凭证</a>
                                <a href="#" class="received-bill-action">标记为异常</a>
                            </td>
                        </tr>
                        <tr data-par="2">
                            <td><a href="#">6756484758785768784</a></td>
                            <td><span class="js-single-price">67367</span> VND</td>
                            <td>张三</td>
                        </tr>
                        <tr data-par="2">
                            <td><a href="#">6756484758785768784</a></td>
                            <td><span class="js-single-price">67367</span> VND</td>
                            <td>张三</td>
                        </tr>
                        <tr data-par="2">
                            <td><a href="#">6756484758785768784</a></td>
                            <td><span class="js-single-price">67367</span> VND</td>
                            <td>张三</td>
                        </tr>
                        <tr data-par="2">
                            <td><a href="#">6756484758785768784</a></td>
                            <td><span class="js-single-price">67367</span> VND</td>
                            <td>张三</td>
                        </tr>
                        <tr data-par="2">
                            <td><a href="#">6756484758785768784</a></td>
                            <td><span class="js-single-price">67367</span> VND</td>
                            <td>张三</td>
                        </tr>
                        <tr data-par="2">
                            <td><a href="#">6756484758785768784</a></td>
                            <td><span class="js-single-price">67367</span> VND</td>
                            <td>张三</td>
                        </tr>
                    </tbody>
                </table>
                <div class="text-right">
                    <ul class="pagination">
                        <li class="disabled"><a href="#">&laquo;</a></li>
                        <li class="active"><a href="#">1</a></li>
                        <li><a href="#">2</a></li>
                        <li><a href="#">3</a></li>
                        <li><a href="#">4</a></li>
                        <li><a href="#">5</a></li>
                        <li><a href="#">&raquo;</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="./js/libs/jquery-1.11.2.min.js"></script>
<script src="./js/libs/bootstrap.min.js"></script>
<script src="./js/libs/bootstrap-datepicker.min.js"></script>
<script src="./js/getUrlArg.js"></script>
<script src="./js/ck_lang.js"></script>

<script>
    $(document).ready(function() {
        var lang = $.getUrlArg('language');
        $('#submit-range').datepicker({
            format: "yyyy/mm/dd",
            orientation: "top right",
            language: lang
        });

        var $main = $('.received-bill');
        function calculatePrice () {
            var mainValue = 0;
            var $trSet = $main.find('.js-this-tr');
            $trSet.each(function(){
                var $this = $(this);
                var initValue =Number($this.find('.js-single-price').text());
                var thisTrId = $this.data('id');
                var $thisSubSet = $main.find('tr[data-par="'+thisTrId+'"]');
                $thisSubSet.each(function(){
                    var $that = $(this);
                    initValue=initValue+Number($that.find('.js-single-price').text());
                });
                mainValue = mainValue + initValue;
                $this.find('.js-sub-total').text(initValue);
            });
            $main.find('.js-received-bill-total').text(mainValue);
        }
        calculatePrice();
    });
</script>
</body>
</html>